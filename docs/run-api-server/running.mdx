---
title: Running
sidebar_position: 40
---

import { CodeExample } from "@site/src/components/CodeExample";

Once your Horizon database and Captive Core configuration is set up properly, you're ready to run Horizon.

To run `stellar-horizon` binary direct with the [appropriate parameters](./configuring.mdx#parameters) set (or `stellar-horizon-cmd serve` if you [installed via the package manager](./installing.mdx#package-manager), which will automatically import your configuration from `/etc/default/stellar-horizon`).

To run on Kubernetes using helm chart, ensure you have followed the [pre-requisite](./installing.mdx#helm-chart-installation) of installing the Helm cli tool and adding the Stellar chart repo to helm client.

The horizon process [requires access to a Postgres 12+ database](./configuring.mdx#preparing-the-database), first use the common kubernetes cli tool `kubectl` from your workstation to create a kubernetes secret on the intended namespace of the kubernetes cluster which will hold the horizon database url.

<CodeExample>

```bash
# copy your horizon DATABASE_URL into a secure file, no line breaks.
echo -n 'database_url_here' > my_creds.txt

# now generate the kubernetes secret from the file
kubectl create secret generic \
-n my-namepsace\
my-db-secret \
--from-file=DATABASE_URL=my_creds.txt
```

</CodeExample>

Now deploy horizon onto the cluster using the helm chart, this example includes usage of `--devel` to enable using the latest development version of published helm chart:

<CodeExample>

```bash
helm install my-horizon stellar/horizon   \
--namespace my-namespace  \
--set ingest.persistence.enabled=true \
--set web.enabled=true \
--set web.existingSecret=my-db-secret \
--set global.image.horizon.tag=2.26.1 \
--set global.network=testnet \
--set ingest.existingSecret=my-db-secret \
--set ingest.horizonConfig.captiveCoreUseDb=true \
--set ingest.resources.limits.cpu=2 \
--set ingest.resources.limits.memory=6Gi \
--devel
```

</CodeExample>

This example of helm chart usage, shows using the `global.network=[testnet|pubnet]` parameter, this automates generation of all the horizon configuration parameters specific to network such as archive urls, captive core config, etc and other parameters as mentioned on [Configuring](./configuring.mdx). This example also enabled all roles on the deployment instance: ingesting, api, transaction submission. If you want to use a different network other than testnet or pubnet, or customize more of the other settings, the best approach is to checkout locally the [horizon helm chart values.yaml](https://github.com/stellar/helm-charts/blob/main/charts/horizon/values.yaml), update the settings in values.yaml, and pass to install:

<CodeExample>

```bash
helm install myhorizon \
stellar/horizon \
--namespace my-horizon-namespace-on-cluster \
-f values.yaml
```

</CodeExample>

Specific to network configuration parameters, if you want to connect to a network other than testnet or pubnet, then you won't use `global.network`, instead, use the values.yaml locally and set `ingest.coreConfig`, and refer to [\_core-config.tpl](https://github.com/stellar/helm-charts/blob/main/charts/horizon/templates/_core-config.tpl) for example of all the key/value pairs to include.

<br />

Horizon will start HTTP server and logging to standard out. You should see output similar to:

<CodeExample>

```
INFO[...] Starting horizon on :8000                     pid=29013
```

</CodeExample>

Note that the numbers may naturally be different for your installation. The log line above announces that Horizon is ready to serve client requests.

Next, you can confirm that Horizon is responding correctly by loading the root resource. In the example above, that URL would be http://127.0.0.1:8000/, and simply running `curl http://127.0.0.1:8000/` would show you that the root resource loads correctly:

<CodeExample>

```json
{
  "_links": {
    "account": {
      "href": "http://127.0.0.1:8000/accounts/{account_id}",
      "templated": true
    },
    "accounts": {
      "href": "http://127.0.0.1:8000/accounts{?signer,sponsor,asset,cursor,limit,order}",
      "templated": true
    }
  }
  // etc.
}
```

</CodeExample>
